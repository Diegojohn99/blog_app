<div class="auth-wrapper">
  <h2>Crear Cuenta</h2>

  <%= form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f| %>
    <%= render "devise/shared/error_messages", resource: resource %>

    <div class="form-group">
      <%= f.label :email %>
      <%= f.email_field :email, autofocus: true, autocomplete: "email", placeholder: "ejemplo@correo.com" %>
    </div>

    <div class="form-group">
      <%= f.label :password, "Contraseña" %>
      <% if @minimum_password_length %>
      <em style="font-size: 0.8rem; color: #666;">(<%= @minimum_password_length %> caracteres mínimo)</em>
      <% end %>
      <div style="position: relative;">
        <%= f.password_field :password, autocomplete: "new-password", id: "user_password" %>
        <button type="button" onclick="generatePassword()" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: var(--yahoo-purple); color: white; border: none; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; cursor: pointer;">
          Generar
        </button>
      </div>
      <div id="password-suggestions" style="margin-top: 8px; font-size: 0.85rem; color: #666;"></div>
    </div>

    <div class="form-group">
      <%= f.label :password_confirmation, "Confirmar Contraseña" %>
      <%= f.password_field :password_confirmation, autocomplete: "new-password", id: "user_password_confirmation" %>
    </div>

    <div class="actions">
      <%= f.submit "Registrarse", class: "btn-primary", style: "width: 100%; padding: 12px; border-radius: 4px;" %>
    </div>
  <% end %>

  <div style="margin-top: 20px; text-align: center; font-size: 0.9rem;">
    <%= render "devise/shared/links" %>
  </div>
</div>

<script>
function generatePassword() {
  const length = 12;
  const charset = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*";
  let password = "";
  for (let i = 0; i < length; i++) {
    password += charset.charAt(Math.floor(Math.random() * charset.length));
  }
  
  document.getElementById('user_password').value = password;
  document.getElementById('user_password_confirmation').value = password;
  document.getElementById('user_password').type = 'text';
  
  document.getElementById('password-suggestions').innerHTML = 
    '<span style="color: green;">✓ Contraseña generada: <strong>' + password + '</strong></span><br>' +
    '<small>Copia esta contraseña antes de continuar</small>';
  
  setTimeout(() => {
    document.getElementById('user_password').type = 'password';
  }, 3000);
}
</script>
